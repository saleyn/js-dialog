(()=>{function L(){let T=this,E="dlg-window";class v{constructor(e,o,n,f,p,b,d={}){let i=localStorage.getItem(t.Defaults.persistKey);(i===null||i==="null")&&(i=void 0);let a=d.theme||(i!==void 0?i:document.body.classList.contains("dark-mode")?"dark":document.body.classList.contains("light-mode")?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),r=a==="dark",u=`dlg-${a}-mode`;(i===void 0||d.theme!=null&&i!=d.theme)&&localStorage.setItem(t.Defaults.persistKey,a);let g=t.Defaults.themes[a];if(!g)throw new Error(`Invalid dialog theme found for '${d.theme}': ${a}`);d=t.deepClone(t.Defaults,d);let s=t.Defaults.className;e=(e||s).replace("#","");let h=t.openDialogs.ids.length?t.openDialogs.ids[t.openDialogs.ids.length-1].index+1:0;this.id=h?`${e}-${h}`:e,this.index=h,d.persistent=d.persistent?`${this.id}-${o.toLowerCase()}`:void 0,this.element=document.getElementById(this.id);let y=document.getElementById(e);this.element||(this.element=document.createElement("div"),(this.index?document.getElementById(e):document.body).appendChild(this.element),this.element.setAttribute("id",this.id),this.addedToParent=!0),this.element.style.display="none",this.element.innerHTML=`
        <div id="${this.id}-box"  class="dlg-box">
        <div id="${this.id}-head" class="dlg-head">
        <div id="${this.id}-top"  class="dlg-top"><div class="dlg-title">${n}</div>
        <div id="${this.id}-x"    class="dlg-x">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="18px" height="18px" onclick="Dialog.close('${this.id}')" title="Close">
        <path fill="#F44336" d="M21.5 4.5H26.501V43.5H21.5z" transform="rotate(45.001 24 24)"/>
        <path fill="#F44336" d="M21.5 4.5H26.5V43.501H21.5z" transform="rotate(135.008 24 24)"/></svg>
        </div></div></div>
        <div id="${this.id}-body" class="dlg-body"></div>
        <div id="${this.id}-foot" class="dlg-foot"></div></div>`,this.index==0&&(this.element.style.visibility="visible",this.element.style.opacity="1",this.element.classList.add(s),t.Defaults.transition&&(this.element.classList.add("dlg-fadein"),this.element.classList.remove("dlg-fadeout"))),this.oldKeyDown=document.onkeydown,document.onkeydown=w=>{w.key=="Escape"&&this.close()};let m=document.getElementById(`${this.id}-box`),I=document.getElementById(`${this.id}-head`),M=document.getElementById(`${this.id}-top`),O=document.getElementById(`${this.id}-title`),A=document.getElementById(`${this.id}-x`),C=document.getElementById(`${this.id}-body`),B=document.getElementById(`${this.id}-foot`);C.innerHTML=f,B.innerHTML=p;let x=document.getElementById(`${s}-box`),$=x?x.offsetTop+this.index*20:m.offsetTop,D=x?x.offsetLeft+this.index*20:m.offsetLeft;if(this.index==0){if(d.persistent)try{let c=JSON.parse(localStorage.getItem(d.persistent));c&&c.top&&($=parseInt(/\d+/.exec(c.top)[0])),c&&c.left&&(D=parseInt(/\d+/.exec(c.left)[0]))}catch{}let w=t.deepClone(d.default.colors,g.colors),j=`#${s} {
`+Object.entries(w).map(c=>`--${c[0]}: ${c[1]};
`).join("")+`}
`+Object.entries(d.css).map(c=>c[0]=="window"?c[1].replace("{{ClassName}}",s):c[1]).join(`
`),k=`${this.id}-style`;if(!document.getElementById(k)){let c=document.createElement("style");c.setAttribute("id",k),c.type="text/css",c.innerHTML=j,document.getElementsByTagName("head")[0].appendChild(c)}}d={persistent:d.persistent},t.dragElement(m,I,Object.assign(d,{top:$,left:D})),this.element.style.display="block",m.style.display="block",t.openDialogs.ids.push({id:this.id,ele:e,index:this.index,instance:this}),this.promptType=o,this.oncloseArgs=b}close=(...e)=>{if(this.closePending||(typeof this.oncloseArgs=="function"?this.oncloseArgs(...e):window[this.oncloseArgs]&&(window[this.oncloseArgs](...e),this.waitForClose=!0)),this.closePending=!0,t.openDialogs.ids.length&&t.openDialogs.ids[t.openDialogs.ids.length-1].id===this.id){if(document.onkeydown=this.oldKeyDown,t.openDialogs.ids.pop(),this.element.innerHTML="",this.id==t.Defaults.className){let n=this.addedToParent,f=this.element;t.Defaults.transition&&(f.classList.remove("dlg-fadein"),f.classList.add("dlg-fadeout")),setTimeout(()=>{n?f.parentElement.removeChild(f):f.style.display="none"},t.Defaults.transition?400:0)}else this.element.style.display="none",this.addedToParent&&this.element.parentElement.removeChild(this.element);delete this;let o=t.openDialogs.ids.length?t.openDialogs.ids[t.openDialogs.ids.length-1].instance:void 0;o&&o.close()}};toggleTheme=()=>{let e=localStorage.getItem(t.Defaults.persistKey),o=e=="dark"?"light":"dark";confirm(`Are you sure you want to toggle dialog theme from '${e}' to '${o}'?`)&&localStorage.setItem(t.Defaults.persistKey,o)}}return{Defaults:{persistent:!1,persistKey:"dlg-theme-mode",theme:"dark",className:E,transition:!0,css:{window:`.{{ClassName}} {
            z-index:    10;
            position:   fixed; top: 0px; left: 0px; height: 100%; width: 100%;
            background-color: var(--dlg-win-bg-color);
          }
          .{{ClassName}}.dlg-fadein  { animation: dlg-fadein  0.5s; }
          .{{ClassName}}.dlg-fadeout { animation: dlg-fadeout 0.5s; }
          @keyframes     dlg-fadein  { 0% { opacity:0; } 100% { opacity:1; } }
          @keyframes     dlg-fadeout { 0% { opacity:1; } 100% { opacity:0; } }

          .dlg-box .dlg-head,
          .dlg-box .dlg-foot {
            -webkit-user-select:none;
            -moz-user-select:-moz-none;
            -ms-user-select:none;
            user-select:none;
          }`,header:`.dlg-box .dlg-top { width: 100%; display: flex; }
          .dlg-box .dlg-top > .dlg-title{ width: 90%; }
          .dlg-box .dlg-top > .dlg-x    { width: 10%; display: flex; justify-content: end; cursor: auto; }
          .dlg-box .dlg-top > .dlg-x > button { background-color: transparent; border: none; padding-left: 3px; }
          .dlg-box .dlg-head{
            font-size:        19px;
            padding:          5px;
            color:            var(--dlg-title-fg-color);
            background-color: var(--dlg-title-bg-color);
            cursor:           move;
          }`,body:`.dlg-box {
            position:     absolute;
            background:   var(--dlg-bg-color);
            border-radius:3px;
            border:       var(--dlg-border-color);
            top:          50%;
            left:         50%;
            -webkit-transform: translate(-50%, -50%);
            transform:    translate(-50%, -50%);
            width:        550px;
            padding:      5px;
            filter: drop-shadow(0 2px 8px rgb(9 9 9 / 0.5)) drop-shadow(0 4px 10px rgb(9 9 9 / 0.5));
            font-size:    initial;
            font-family:  sans-serif;
          }`,dialogBody:`.dlg-box .dlg-body{ background: var(--dlg-body-bg-color); padding:20px; color: var(--dlg-body-fg-color); }
          .dlg-box .dlg-body label { padding-left: 0.35rem; }
          .dlg-box .dlg-body input {
           border: none; padding: 0.25rem;
           color: var(--dlg-input-fg-color); background-color: var(--dlg-input-bg-color); outline: var(--dlg-input-outline);
           filter: drop-shadow(0 1px 2px rgb(0 0 0 / 0.1)) drop-shadow(0 1px 1px rgb(0 0 0 / 0.06));
          }
          .dlg-box .dlg-body input:focus { outline: var(--dlg-input-outline-focus); }`,footer:`.dlg-box .dlg-foot{ padding: 5px 5px 0px 5px; text-align: right; }
          .dlg-box .dlg-foot button.default {
            color: var(--dlg-btn-def-fg-color);
            background-color: var(--dlg-btn-def-bg-color);
          }
          .dlg-box .dlg-foot button {
            padding:       5px 20px 5px 20px;
            margin:        5px 0px 5px 0px;
            border:        var(--dlg-btn-border);
            border-radius: 3px;
            color:         var(--dlg-btn-fg-color);
            background-color: var(--dlg-btn-bg-color);
          }
          .dlg-box .dlg-foot button:active {
            filter: drop-shadow(1px 2px 2px rgb(0 0 0 / 0.5));
          }
          .dlg-box .dlg-foot button:hover {
            color:            var(--dlg-btn-hover-fg-color);
            background-color: var(--dlg-btn-hover-bg-color);
          }`},default:{colors:{"dlg-win-bg-color":"rgba(10,10,10,0.6)","dlg-border-color":"none","dlg-footer-fg-color":"#CCC","dlg-footer-bg-color":"#444","dlg-btn-fg-color":"black"}},themes:{dark:{colors:{"dlg-title-fg-color":"#c6c6cf","dlg-title-bg-color":"#2e2f3a","dlg-bg-color":"#2e2f3a","dlg-body-fg-color":"#9797a2","dlg-body-bg-color":"#2e2f3a","dlg-input-fg-color":"#e4e6ea","dlg-input-bg-color":"#444452","dlg-input-outline":"none","dlg-input-outline-focus":"1px solid #649ad5","dlg-btn-border":"1px solid #649ad5","dlg-btn-fg-color":"#649ad5","dlg-btn-bg-color":"#444452","dlg-btn-hover-fg-color":"white","dlg-btn-hover-bg-color":"#88c1ff","dlg-btn-def-fg-color":"#2e2f3a","dlg-btn-def-bg-color":"#649ad5","dlg-btn-def-hover-fg-color":"white","dlg-btn-def-hover-bg-color":"#88c1ff"}},light:{colors:{"dlg-title-fg-color":"#636363","dlg-title-bg-color":"#f2f3f7","dlg-bg-color":"#f2f3f7","dlg-body-fg-color":"#636363","dlg-body-bg-color":"#f2f3f7","dlg-input-fg-color":"#636363","dlg-input-bg-color":"white","dlg-input-outline":"1px solid #d7d7d7","dlg-input-outline-focus":"1px solid #649ad5","dlg-btn-border":"1px solid #649ad5","dlg-btn-fg-color":"#649ad5","dlg-btn-bg-color":"white","dlg-btn-active-bg-color":"blue","dlg-btn-hover-fg-color":"white","dlg-btn-hover-bg-color":"#88c1ff","dlg-btn-def-fg-color":"#EEE","dlg-btn-def-bg-color":"#649ad5","dlg-btn-hover-border":"1px solid blue","dlg-btn-def-hover-fg-color":"white","dlg-btn-def-hover-bg-color":"#88c1ff"}}}},openDialogs:{ids:[]},close:(l,...e)=>{if(t.openDialogs.ids.length==0)return;let o=l!=null?t.openDialogs.ids.find(n=>n.id===l):t.openDialogs.ids[t.openDialogs.ids.length-1];if(o!==void 0)o.instance.close(...e);else throw new Error(`Cannot find Dialog with id=${l}`)},deepClone:(l,e=void 0,o=()=>!0)=>{let n={};function f(p,b,d){for(let[i,a]of Object.entries(b)){if(!o(d,i))continue;if(Array.isArray(a)){p[i]=a.slice();continue}else if(a===null||typeof a!="object"){p[i]=a;continue}p[i]===void 0&&(p[i]=new a.__proto__.constructor);let r=[...d,i];f(p[i],a,r)}}return f(n,l,[]),e!==void 0&&f(n,e,[]),n},dragElement:(l,e,o={})=>{let n=l,f=e;if(typeof l=="string"&&(l=document.getElementById(l)),typeof e=="string"&&(e=document.getElementById(e)),l==null||typeof l!="object")throw`Cannot find element: ${l}`;if(e==null||typeof l!="object")throw`Cannot find header:  ${e}`;let p=s=>{s=s||window.event,s.preventDefault(),u=s.clientX,g=s.clientY,document.onmouseup=i,document.onmousemove=d},b=(s,h)=>{let y=l.offsetHeight/2,m=l.offsetWidth/2;l.style.top=Math.max(y,Math.min(s,window.innerHeight-y))+"px",l.style.left=Math.max(m,Math.min(h,window.innerWidth-m))+"px"},d=s=>{s=s||window.event,s.preventDefault(),a=u-s.clientX,r=g-s.clientY,u=s.clientX,g=s.clientY,b(l.offsetTop-r,l.offsetLeft-a)},i=()=>{document.onmouseup=null,document.onmousemove=null,o.persistent&&localStorage.setItem(o.persistent,JSON.stringify({top:l.offsetTop,left:l.offsetLeft}))},a=0,r=0,u=0,g=0;e.onmousedown=p,(o.top||o.left)&&b(o.top,o.left)},alert:(l,e,o,n={})=>new v(n.element,"Alert",l,e,`<button class="default" onclick="Dialog.close(${n.element})">OK</button>`,o,n),confirm:(l,e,o,n={})=>{let f=n.buttons||[{title:"Ok"},{title:"Cancel"}],p=n.btnOk||0,b=n.defbtn||0,d=f.map((i,a)=>{let r=Object.keys(i).filter(u=>u!="value");return`<button${b==a?' class="default"':""} onclick="Dialog.close(${n.element}, ${a==p})"`+r.map(u=>` ${u}=${i[u]}`).join("")+`>${i.value?i.value:i.title}</button>
`}).join("");return new v(n.element,"Confirm",l,e,d,o,n)},prompt:(l,e,o,n={})=>{let f=n.inputs||[{label:"Enter a value",id:"value"}],p=n.buttons||[{title:"Ok"},{title:"Cancel"}],b=n.defbtn||0,d=n.element;e+=f.map((r,u)=>`<label for="${r.id}" text="${r.label}"/><input id="${r.id}"`+Object.keys(r).filter(g=>g!="label").map(g=>` ${g}="${r[g]}"`).join("")+">").join("");let i=p.map((r,u)=>`<button ${u==b?" class='default'":""}`+Object.keys(r).filter(g=>g!="value").map(g=>` ${g}="${r[g]}"`).join("")+` onclick="Dialog.close(${d}, ${u})">${r.value?r.value:r.title}</button>
`).join(""),a=r=>{let u=f.map(s=>{let h=document.getElementById(s.id),m=h&&h!=null&&h.value?h.value:void 0;return{id:s.id,value:m}}),g={ok:r==b,button:r,values:u};return typeof o=="function"?o(g):o!==void 0&&window[o]?window[o](g):g};return new v(d,"Prompt",l,e,i,a,n)}}}var t=L(),N=t;window.Dialog=t;})();
