(()=>{function M(){let T=this,y="dlg-window";class ${constructor(e,t,l,p,f,h,n={}){let d=localStorage.getItem(i.Defaults.persistKey);(d===null||d==="null")&&(d=void 0);let g=n.theme||(d!==void 0?d:document.body.classList.contains("dark-mode")?"dark":document.body.classList.contains("light-mode")?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),s=g==="dark",a=`dlg-${g}-mode`;(d===void 0||n.theme!=null&&d!=n.theme)&&localStorage.setItem(i.Defaults.persistKey,g);let c=i.Defaults.themes[g];if(!c)throw new Error(`Invalid dialog theme found for '${n.theme}': ${g}`);n=i.deepClone(i.Defaults,n),e=(e||y).replace("#","");let r,m=1;do r=`${e}-${m++}`;while(i.openDialogs.ids.find(v=>v.id===r)!==void 0);this.id=m==1?e:r,this.index=m-1,n.persistent=n.persistent?`${this.id}-${t.toLowerCase()}`:void 0;let u=document.getElementById(e);this.element=this.index==1&&u!==void 0?u:document.getElementById(this.id),this.element||(this.index==1&&u?this.element=u:(this.element=document.createElement("div"),this.element.setAttribute("id",this.id),u?u.appendChild(this.element):document.body.appendChild(this.element),this.addedToParent=!0,u||(u=this.element))),this.index==1&&this.element.classList.add(y),this.element.innerHTML=`
        <div id="${this.id}-box"  class="dlg-box">
        <div id="${this.id}-head" class="dlg-head">
        <div id="${this.id}-top"  class="dlg-top"><div class="dlg-title">${l}</div>
        <div id="${this.id}-x"    class="dlg-x">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="18px" height="18px" onclick="Dialog.close('${this.id}')" title="Close">
        <path fill="#F44336" d="M21.5 4.5H26.501V43.5H21.5z" transform="rotate(45.001 24 24)"/>
        <path fill="#F44336" d="M21.5 4.5H26.5V43.501H21.5z" transform="rotate(135.008 24 24)"/></svg>
        </div></div></div>
        <div id="${this.id}-body" class="dlg-body"></div>
        <div id="${this.id}-foot" class="dlg-foot"></div></div>`,this.element.style.display="none",this.oldKeyDown=document.onkeydown,document.onkeydown=v=>{v.key=="Escape"&&this.close()};let x=document.getElementById(`${this.id}-box`),I=document.getElementById(`${this.id}-head`),L=document.getElementById(`${this.id}-top`),O=document.getElementById(`${this.id}-title`),A=document.getElementById(`${this.id}-x`),C=document.getElementById(`${this.id}-body`),j=document.getElementById(`${this.id}-foot`);C.innerHTML=p,j.innerHTML=f;let w=document.getElementById(`${y}-1-box`),D=w?w.offsetTop+(this.index-1)*20:x.offsetTop,E=w?w.offsetLeft+(this.index-1)*20:x.offsetLeft;if(this.index==1){if(n.persistent)try{let b=JSON.parse(localStorage.getItem(n.persistent));b&&b.top&&(D=parseInt(/\d+/.exec(b.top)[0])),b&&b.left&&(E=parseInt(/\d+/.exec(b.left)[0]))}catch{}let v=i.deepClone(n.default.colors,c.colors),B=`.${y} {
`+Object.entries(v).map(b=>`--${b[0]}: ${b[1]};
`).join("")+`}
`+Object.entries(n.css).map(b=>b[1]).join(`
`),k=document.createElement("style");k.type="text/css",k.innerHTML=B,document.getElementsByTagName("head")[0].appendChild(k)}n={persistent:n.persistent},i.dragElement(x,I,Object.assign(n,{top:D,left:E})),this.element.style.display="block",x.style.display="block",i.openDialogs.ids.push({id:this.id,ele:e,instance:this}),this.promptType=t,this.oncloseArgs=h}close=(...e)=>{if(this.closePending||(typeof this.oncloseArgs=="function"?this.oncloseArgs(...e):window[this.oncloseArgs]&&(window[this.oncloseArgs](...e),this.waitForClose=!0)),this.closePending=!0,i.openDialogs.ids.length>0&&i.openDialogs.ids[i.openDialogs.ids.length-1].id===this.id){this.element.style.display="none",this.element.innerHTML="",document.onkeydown=this.oldKeyDown;let t=this.id,l=i.openDialogs.ids.pop();l.addedToParent&&l.element.parentElement.removeChild(l.element),delete l.instance,l=i.openDialogs.ids.length?i.openDialogs.ids[i.openDialogs.ids.length-1].instance:void 0,l&&l.close()}};toggleTheme=()=>{let e=localStorage.getItem(i.Defaults.persistKey),t=e=="dark"?"light":"dark";confirm(`Are you sure you want to toggle dialog theme from '${e}' to '${t}'?`)&&localStorage.setItem(i.Defaults.persistKey,t)}}return{Defaults:{persistent:!1,persistKey:"dlg-theme-mode",theme:"dark",className:y,css:{window:`.${y} {
            display: none;
            background-color: var(--dlg-win-bg-color);
            z-index: 10;
            position: fixed; top: 0px; left: 0px; height: 100%; width: 100%;
          }
          .dlg-box .dlg-head,
          .dlg-box .dlg-foot {
            -webkit-user-select:none;
            -moz-user-select:-moz-none;
            -ms-user-select:none;
            user-select:none;
          }`,header:`.dlg-box .dlg-top { width: 100%; display: flex; }
          .dlg-box .dlg-top > .dlg-title{ width: 90%; }
          .dlg-box .dlg-top > .dlg-x    { width: 10%; display: flex; justify-content: end; cursor: auto; }
          .dlg-box .dlg-top > .dlg-x > button { background-color: transparent; border: none; padding-left: 3px; }
          .dlg-box .dlg-head{
            font-size:        19px;
            padding:          5px;
            color:            var(--dlg-title-fg-color);
            background-color: var(--dlg-title-bg-color);
            cursor:           move;
          }`,body:`.dlg-box {
            position:     absolute;
            background:   var(--dlg-bg-color);
            border-radius:3px;
            border:       var(--dlg-border-color);
            top:          50%;
            left:         50%;
            -webkit-transform: translate(-50%, -50%);
            transform:    translate(-50%, -50%);
            width:        550px;
            padding:      5px;
            filter: drop-shadow(0 10px 8px rgb(9 9 9 / 0.5)) drop-shadow(0 4px 3px rgb(9 9 9 / 0.5));
          }`,dialogBody:`.dlg-box .dlg-body{ background: var(--dlg-body-bg-color); padding:20px; color: var(--dlg-body-fg-color); }
          .dlg-box .dlg-body label { padding-left: 0.35rem; }
          .dlg-box .dlg-body input {
           border: none; padding: 0.25rem;
           color: var(--dlg-input-fg-color); background-color: var(--dlg-input-bg-color); outline: var(--dlg-input-outline);
           filter: drop-shadow(0 1px 2px rgb(0 0 0 / 0.1)) drop-shadow(0 1px 1px rgb(0 0 0 / 0.06));
          }
          .dlg-box .dlg-body input:focus { outline: var(--dlg-input-outline-focus); }`,footer:`.dlg-box .dlg-foot{ padding: 5px 5px 0px 5px; text-align: right; }
          .dlg-box .dlg-foot button.default {
            color: var(--dlg-btn-def-fg-color);
            background-color: var(--dlg-btn-def-bg-color);
          }
          .dlg-box .dlg-foot button {
            padding:       5px 20px 5px 20px;
            margin:        5px 0px 5px 0px;
            border:        var(--dlg-btn-border);
            border-radius: 3px;
            color:         var(--dlg-btn-fg-color);
            background-color: var(--dlg-btn-bg-color);
          }
          .dlg-box .dlg-foot button:active {
            filter: drop-shadow(1px 2px 2px rgb(0 0 0 / 0.5));
          }
          .dlg-box .dlg-foot button:hover {
            color:            var(--dlg-btn-hover-fg-color);
            background-color: var(--dlg-btn-hover-bg-color);
          }`},default:{colors:{"dlg-win-bg-color":"rgba(10,10,10,0.6)","dlg-border-color":"none","dlg-footer-fg-color":"#CCC","dlg-footer-bg-color":"#444","dlg-btn-fg-color":"black"}},themes:{dark:{colors:{"dlg-title-fg-color":"#c6c6cf","dlg-title-bg-color":"#2e2f3a","dlg-bg-color":"#2e2f3a","dlg-body-fg-color":"#9797a2","dlg-body-bg-color":"#2e2f3a","dlg-input-fg-color":"#e4e6ea","dlg-input-bg-color":"#444452","dlg-input-outline":"none","dlg-input-outline-focus":"1px solid #649ad5","dlg-btn-border":"1px solid #649ad5","dlg-btn-fg-color":"#649ad5","dlg-btn-bg-color":"#444452","dlg-btn-hover-fg-color":"white","dlg-btn-hover-bg-color":"#88c1ff","dlg-btn-def-fg-color":"#2e2f3a","dlg-btn-def-bg-color":"#649ad5","dlg-btn-def-hover-fg-color":"white","dlg-btn-def-hover-bg-color":"#88c1ff"}},light:{colors:{"dlg-title-fg-color":"#636363","dlg-title-bg-color":"#f2f3f7","dlg-bg-color":"#f2f3f7","dlg-body-fg-color":"#636363","dlg-body-bg-color":"#f2f3f7","dlg-input-fg-color":"#636363","dlg-input-bg-color":"white","dlg-input-outline":"1px solid #d7d7d7","dlg-input-outline-focus":"1px solid #649ad5","dlg-btn-border":"1px solid #649ad5","dlg-btn-fg-color":"#649ad5","dlg-btn-bg-color":"white","dlg-btn-active-bg-color":"blue","dlg-btn-hover-fg-color":"white","dlg-btn-hover-bg-color":"#88c1ff","dlg-btn-def-fg-color":"#EEE","dlg-btn-def-bg-color":"#649ad5","dlg-btn-hover-border":"1px solid blue","dlg-btn-def-hover-fg-color":"white","dlg-btn-def-hover-bg-color":"#88c1ff"}}}},openDialogs:{ids:[]},close:(o,...e)=>{if(i.openDialogs.ids.length==0)return;let t=o!=null?i.openDialogs.ids.find(l=>l.id===o):i.openDialogs.ids[i.openDialogs.ids.length-1];if(t!==void 0)t.instance.close(...e);else throw new Error(`Cannot find Dialog with id=${o}`)},deepClone:(o,e=void 0,t=()=>!0)=>{let l={};function p(f,h,n){for(let[d,g]of Object.entries(h)){if(!t(n,d))continue;if(Array.isArray(g)){f[d]=g.slice();continue}else if(g===null||typeof g!="object"){f[d]=g;continue}f[d]===void 0&&(f[d]=new g.__proto__.constructor);let s=[...n,d];p(f[d],g,s)}}return p(l,o,[]),e!==void 0&&p(l,e,[]),l},dragElement:(o,e,t={})=>{let l=o,p=e;if(typeof o=="string"&&(o=document.getElementById(o)),typeof e=="string"&&(e=document.getElementById(e)),o==null||typeof o!="object")throw`Cannot find element: ${o}`;if(e==null||typeof o!="object")throw`Cannot find header:  ${e}`;let f=r=>{r=r||window.event,r.preventDefault(),a=r.clientX,c=r.clientY,document.onmouseup=d,document.onmousemove=n},h=(r,m)=>{let u=o.offsetHeight/2,x=o.offsetWidth/2;o.style.top=Math.max(u,Math.min(r,window.innerHeight-u))+"px",o.style.left=Math.max(x,Math.min(m,window.innerWidth-x))+"px"},n=r=>{r=r||window.event,r.preventDefault(),g=a-r.clientX,s=c-r.clientY,a=r.clientX,c=r.clientY,h(o.offsetTop-s,o.offsetLeft-g)},d=()=>{document.onmouseup=null,document.onmousemove=null,t.persistent&&localStorage.setItem(t.persistent,JSON.stringify({top:o.offsetTop,left:o.offsetLeft}))},g=0,s=0,a=0,c=0;e.onmousedown=f,(t.top||t.left)&&h(t.top,t.left)},alert:(o,e,t={})=>new $(t.element,"Alert",o,e,`<button class="default" onclick="Dialog.close(${t.element})">OK</button>`,void 0,t),confirm:(o,e,t,l={})=>{let p=l.buttons||[{title:"Ok"},{title:"Cancel"}],f=l.btnOk||0,h=l.defbtn||0,n=p.map((d,g)=>{let s=Object.keys(d).filter(a=>a!="value");return`<button${h==g?' class="default"':""} onclick="Dialog.close(${l.element}, ${g==f})"`+s.map(a=>` ${a}=${d[a]}`).join("")+`>${d.value?d.value:d.title}</button>
`}).join("");return new $(l.element,"Confirm",o,e,n,t,l)},prompt:(o,e,t,l={})=>{let p=l.inputs||[{label:"Enter a value",id:"value"}],f=l.buttons||[{title:"Ok"},{title:"Cancel"}],h=l.defbtn||0,n=l.element;e+=p.map((s,a)=>`<label for="${s.id}" text="${s.label}"/><input id="${s.id}"`+Object.keys(s).filter(c=>c!="label").map(c=>` ${c}="${s[c]}"`).join("")+">").join("");let d=f.map((s,a)=>`<button ${a==h?" class='default'":""}`+Object.keys(s).filter(c=>c!="value").map(c=>` ${c}="${s[c]}"`).join("")+` onclick="Dialog.close(${n}, ${a})">${s.value?s.value:s.title}</button>
`).join(""),g=s=>{let a=p.map(r=>{let m=document.getElementById(r.id),x=m&&m!=null&&m.value?m.value:void 0;return{id:r.id,value:x}}),c={ok:s==h,button:s,values:a};return typeof t=="function"?t(c):t!==void 0&&window[t]?window[t](c):c};return new $(n,"Prompt",o,e,d,g,l)}}}var i=M(),H=i;window.Dialog=i;})();
