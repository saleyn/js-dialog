(()=>{function T(){let L=this,I="dlg-window";class w{constructor(t,e,o,c,b,p,d={}){let i=localStorage.getItem(l.Defaults.persistKey);(i===null||i==="null")&&(i=void 0);let s=d.theme||(i!==void 0?i:document.body.classList.contains("dark-mode")?"dark":document.body.classList.contains("light-mode")?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),a=s==="dark";(i===void 0||d.theme!=null&&i!=d.theme)&&localStorage.setItem(l.Defaults.persistKey,s);let f=l.Defaults.themes[s];if(!f)throw new Error(`Invalid dialog theme found for '${d.theme}': ${s}`);d.theme=s,d=l.deepClone(l.Defaults,d);let r=l.Defaults.className;t=(t||r).replace("#","");let g=l.openDialogs.ids.length?l.openDialogs.ids[l.openDialogs.ids.length-1].index+1:0;this.id=g?`${t}-${g}`:t,this.index=g,d.persistent=d.persistent?`${this.id}-${e.toLowerCase()}`:void 0,this.element=document.getElementById(this.id);let y=document.getElementById(t);this.element||(this.element=document.createElement("div"),(this.index?document.getElementById(t):document.body).appendChild(this.element),this.element.setAttribute("id",this.id),this.addedToParent=!0),this.element.style.display="none",this.element.innerHTML=`
        <div id="${this.id}-box"  class="dlg-box">
        <div id="${this.id}-head" class="dlg-head">
        <div id="${this.id}-top"  class="dlg-top"><div class="dlg-title">${o}</div>
        <div id="${this.id}-x"    class="dlg-x">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="18px" height="18px" onclick="Dialog.close('${this.id}')" title="Close">
        <path fill="#F44336" d="M21.5 4.5H26.501V43.5H21.5z" transform="rotate(45.001 24 24)"/>
        <path fill="#F44336" d="M21.5 4.5H26.5V43.501H21.5z" transform="rotate(135.008 24 24)"/></svg>
        </div></div></div>
        <div id="${this.id}-body" class="dlg-body"></div>
        <div id="${this.id}-foot" class="dlg-foot"></div></div>`,this.index==0&&(this.element.style.visibility="visible",this.element.style.opacity="1",this.element.classList.add(r),l.Defaults.transition&&(this.element.classList.add("dlg-fadein"),this.element.classList.remove("dlg-fadeout"))),this.oldKeyDown=document.onkeydown,document.onkeydown=$=>{$.key=="Escape"&&this.close()};let m=document.getElementById(`${this.id}-box`),x=document.getElementById(`${this.id}-head`),M=document.getElementById(`${this.id}-top`),A=document.getElementById(`${this.id}-title`),O=document.getElementById(`${this.id}-x`),C=document.getElementById(`${this.id}-body`),j=document.getElementById(`${this.id}-foot`);C.innerHTML=c,j.innerHTML=b;let v=document.getElementById(`${r}-box`),D=v?v.offsetTop+this.index*20:m.offsetTop,k=v?v.offsetLeft+this.index*20:m.offsetLeft;if(this.index==0){if(d.persistent)try{let u=JSON.parse(localStorage.getItem(d.persistent));u&&u.top&&(D=parseInt(/\d+/.exec(u.top)[0])),u&&u.left&&(k=parseInt(/\d+/.exec(u.left)[0]))}catch{}let $=l.deepClone(d.default.colors,f.colors),B=`#${r} {
`+Object.entries($).map(u=>`--${u[0]}: ${u[1]};
`).join("")+`}
`+Object.entries(d.css).map(u=>u[0]=="window"?u[1].replace("{{ClassName}}",r):u[1]).join(`
`),E=`${this.id}-style`,h=document.getElementById(E);h&&h.getAttribute("theme")!==s&&(h.remove(),h=null),h||(h=document.createElement("style"),h.setAttribute("id",E),h.setAttribute("theme",s),h.type="text/css",h.innerHTML=B,document.getElementsByTagName("head")[0].appendChild(h))}d={persistent:d.persistent},l.dragElement(m,x,Object.assign(d,{top:D,left:k})),this.element.style.display="block",m.style.display="block",l.openDialogs.ids.push({id:this.id,ele:t,index:this.index,instance:this}),this.promptType=e,this.oncloseArgs=p}close=(...t)=>{if(this.closePending||(typeof this.oncloseArgs=="function"?this.oncloseArgs(...t):window[this.oncloseArgs]&&(window[this.oncloseArgs](...t),this.waitForClose=!0)),this.closePending=!0,l.openDialogs.ids.length&&l.openDialogs.ids[l.openDialogs.ids.length-1].id===this.id){if(document.onkeydown=this.oldKeyDown,l.openDialogs.ids.pop(),this.element.innerHTML="",this.id==l.Defaults.className){let o=this.addedToParent,c=this.element;l.Defaults.transition&&(c.classList.remove("dlg-fadein"),c.classList.add("dlg-fadeout")),setTimeout(()=>{o?c.parentElement.removeChild(c):c.style.display="none"},l.Defaults.transition?400:0)}else this.element.style.display="none",this.addedToParent&&this.element.parentElement.removeChild(this.element);delete this;let e=l.openDialogs.ids.length?l.openDialogs.ids[l.openDialogs.ids.length-1].instance:void 0;e&&e.close()}};toggleTheme=()=>{let t=localStorage.getItem(l.Defaults.persistKey),e=t=="dark"?"light":"dark";confirm(`Are you sure you want to toggle dialog theme from '${t}' to '${e}'?`)&&localStorage.setItem(l.Defaults.persistKey,e)}}return{Defaults:{persistent:!1,persistKey:"dlg-theme-mode",theme:"dark",className:I,transition:!0,css:{window:`.{{ClassName}} {
            z-index:    10;
            position:   fixed; top: 0px; left: 0px; height: 100%; width: 100%;
            background-color: var(--dlg-win-bg-color);
          }
          .{{ClassName}}.dlg-fadein  { animation: dlg-fadein  0.5s; }
          .{{ClassName}}.dlg-fadeout { animation: dlg-fadeout 0.5s; }
          @keyframes     dlg-fadein  { 0% { opacity:0; } 100% { opacity:1; } }
          @keyframes     dlg-fadeout { 0% { opacity:1; } 100% { opacity:0; } }

          .dlg-box .dlg-head,
          .dlg-box .dlg-foot {
            -webkit-user-select:none;
            -moz-user-select:-moz-none;
            -ms-user-select:none;
            user-select:none;
          }`,header:`.dlg-box .dlg-top { width: 100%; display: flex; }
          .dlg-box .dlg-top > .dlg-title{ width: 90%; }
          .dlg-box .dlg-top > .dlg-x    { width: 10%; display: flex; justify-content: end; cursor: auto; }
          .dlg-box .dlg-top > .dlg-x > button { background-color: transparent; border: none; padding-left: 3px; }
          .dlg-box .dlg-head{
            font-size:        19px;
            padding:          5px;
            color:            var(--dlg-title-fg-color);
            background-color: var(--dlg-title-bg-color);
            cursor:           move;
          }`,body:`.dlg-box {
            position:     absolute;
            background:   var(--dlg-bg-color);
            border-radius:3px;
            border:       var(--dlg-border-color);
            top:          50%;
            left:         50%;
            -webkit-transform: translate(-50%, -50%);
            transform:    translate(-50%, -50%);
            width:        550px;
            padding:      5px;
            filter: drop-shadow(0 2px 8px rgb(9 9 9 / 0.5)) drop-shadow(0 4px 10px rgb(9 9 9 / 0.5));
            font-size:    initial;
            font-family:  sans-serif;
          }`,dialogBody:`.dlg-box .dlg-body{ background: var(--dlg-body-bg-color); padding:20px; color: var(--dlg-body-fg-color); }
          .dlg-box .dlg-body label { padding-left: 0.35rem; }
          .dlg-box .dlg-body input {
           border: none; padding: 0.25rem;
           color: var(--dlg-input-fg-color); background-color: var(--dlg-input-bg-color); outline: var(--dlg-input-outline);
           filter: drop-shadow(0 1px 2px rgb(0 0 0 / 0.1)) drop-shadow(0 1px 1px rgb(0 0 0 / 0.06));
          }
          .dlg-box .dlg-body input:focus { outline: var(--dlg-input-outline-focus); }`,footer:`.dlg-box .dlg-foot{ padding: 5px 5px 0px 5px; text-align: right; }
          .dlg-box .dlg-foot button.default {
            color: var(--dlg-btn-def-fg-color);
            background-color: var(--dlg-btn-def-bg-color);
          }
          .dlg-box .dlg-foot button {
            padding:       5px 20px 5px 20px;
            margin:        5px 0px 5px 0px;
            border:        var(--dlg-btn-border);
            border-radius: 3px;
            color:         var(--dlg-btn-fg-color);
            background-color: var(--dlg-btn-bg-color);
          }
          .dlg-box .dlg-foot button:active {
            filter: drop-shadow(1px 2px 2px rgb(0 0 0 / 0.5));
          }
          .dlg-box .dlg-foot button:hover {
            color:            var(--dlg-btn-hover-fg-color);
            background-color: var(--dlg-btn-hover-bg-color);
          }`},default:{colors:{"dlg-win-bg-color":"rgba(10,10,10,0.6)","dlg-border-color":"none","dlg-footer-fg-color":"#CCC","dlg-footer-bg-color":"#444","dlg-btn-fg-color":"black"}},themes:{dark:{colors:{"dlg-title-fg-color":"#c6c6cf","dlg-title-bg-color":"#2e2f3a","dlg-bg-color":"#2e2f3a","dlg-body-fg-color":"#9797a2","dlg-body-bg-color":"#2e2f3a","dlg-input-fg-color":"#e4e6ea","dlg-input-bg-color":"#444452","dlg-input-outline":"none","dlg-input-outline-focus":"1px solid #649ad5","dlg-btn-border":"1px solid #649ad5","dlg-btn-fg-color":"#649ad5","dlg-btn-bg-color":"#444452","dlg-btn-hover-fg-color":"white","dlg-btn-hover-bg-color":"#88c1ff","dlg-btn-def-fg-color":"#2e2f3a","dlg-btn-def-bg-color":"#649ad5","dlg-btn-def-hover-fg-color":"white","dlg-btn-def-hover-bg-color":"#88c1ff"}},light:{colors:{"dlg-title-fg-color":"#636363","dlg-title-bg-color":"#f2f3f7","dlg-bg-color":"#f2f3f7","dlg-body-fg-color":"#636363","dlg-body-bg-color":"#f2f3f7","dlg-input-fg-color":"#636363","dlg-input-bg-color":"white","dlg-input-outline":"1px solid #d7d7d7","dlg-input-outline-focus":"1px solid #649ad5","dlg-btn-border":"1px solid #649ad5","dlg-btn-fg-color":"#649ad5","dlg-btn-bg-color":"white","dlg-btn-active-bg-color":"blue","dlg-btn-hover-fg-color":"white","dlg-btn-hover-bg-color":"#88c1ff","dlg-btn-def-fg-color":"#EEE","dlg-btn-def-bg-color":"#649ad5","dlg-btn-hover-border":"1px solid blue","dlg-btn-def-hover-fg-color":"white","dlg-btn-def-hover-bg-color":"#88c1ff"}}}},openDialogs:{ids:[]},close:(n,...t)=>{if(l.openDialogs.ids.length==0)return;let e=n!=null?l.openDialogs.ids.find(o=>o.id===n):l.openDialogs.ids[l.openDialogs.ids.length-1];if(e!==void 0)e.instance.close(...t);else throw new Error(`Cannot find Dialog with id=${n}`)},deepClone:(n,t=void 0,e=()=>!0)=>{let o={};function c(b,p,d){for(let[i,s]of Object.entries(p)){if(!e(d,i))continue;if(Array.isArray(s)){b[i]=s.slice();continue}else if(s===null||typeof s!="object"){b[i]=s;continue}b[i]===void 0&&(b[i]=new s.__proto__.constructor);let a=[...d,i];c(b[i],s,a)}}return c(o,n,[]),t!==void 0&&c(o,t,[]),o},dragElement:(n,t,e={})=>{let o=n,c=t;if(typeof n=="string"&&(n=document.getElementById(n)),typeof t=="string"&&(t=document.getElementById(t)),n==null||typeof n!="object")throw`Cannot find element: ${n}`;if(t==null||typeof n!="object")throw`Cannot find header:  ${t}`;let b=g=>{g=g||window.event,g.preventDefault(),f=g.clientX,r=g.clientY,document.onmouseup=i,document.onmousemove=d},p=(g,y)=>{let m=n.offsetHeight/2,x=n.offsetWidth/2;n.style.top=Math.max(m,Math.min(g,window.innerHeight-m))+"px",n.style.left=Math.max(x,Math.min(y,window.innerWidth-x))+"px"},d=g=>{g=g||window.event,g.preventDefault(),s=f-g.clientX,a=r-g.clientY,f=g.clientX,r=g.clientY,p(n.offsetTop-a,n.offsetLeft-s)},i=()=>{document.onmouseup=null,document.onmousemove=null,e.persistent&&localStorage.setItem(e.persistent,JSON.stringify({top:n.offsetTop,left:n.offsetLeft}))},s=0,a=0,f=0,r=0;t.onmousedown=b,(e.top||e.left)&&p(e.top,e.left)},alert:(n,t,e,o={})=>new w(o.element,"Alert",n,t,`<button class="default" onclick="Dialog.close(${o.element})">OK</button>`,typeof e=="object"?e.action:e,typeof e=="object"?e:o),confirm:(n,t,e,o={})=>{typeof e=="object"&&(o=e,e=o.action);let c=o.buttons||[{title:"Ok"},{title:"Cancel"}],b=o.btnOk||0,p=o.defbtn||0,d=c.map((i,s)=>{let a=Object.keys(i).filter(f=>f!="value");return`<button${p==s?' class="default"':""} onclick="Dialog.close(${o.element}, ${s==b})"`+a.map(f=>` ${f}=${i[f]}`).join("")+`>${i.value?i.value:i.title}</button>
`}).join("");return new w(o.element,"Confirm",n,t,d,e,o)},prompt:(n,t,e,o={})=>{typeof e=="object"&&(o=e,e=o.action);let c=o.inputs||[{label:"Enter a value",id:"value"}],b=o.buttons||[{title:"Ok"},{title:"Cancel"}],p=o.defbtn||0,d=o.element;t+=c.map((a,f)=>`<label for="${a.id}" text="${a.label}"/><input id="${a.id}"`+Object.keys(a).filter(r=>r!="label").map(r=>` ${r}="${a[r]}"`).join("")+">").join("");let i=b.map((a,f)=>`<button ${f==p?" class='default'":""}`+Object.keys(a).filter(r=>r!="value").map(r=>` ${r}="${a[r]}"`).join("")+` onclick="Dialog.close(${d}, ${f})">${a.value?a.value:a.title}</button>
`).join(""),s=a=>{let f=c.map(g=>{let y=document.getElementById(g.id),x=y&&y!=null&&y.value?y.value:void 0;return{id:g.id,value:x}}),r={ok:a==p,button:a,values:f};return typeof e=="function"?e(r):e!==void 0&&window[e]?window[e](r):r};return new w(d,"Prompt",n,t,i,s,o)}}}var l=T(),N=l;window.Dialog=l;})();
